<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word Order Practice</title>

<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: auto;
    padding: 20px;
    text-align: center;
  }

  h2 { font-size: 24px; }

  #info {
    font-size: 18px;
    margin-bottom: 10px;
  }

  #wordButtons {
    margin: 15px 0;
  }

  .wordBtn {
    font-size: 18px;
    padding: 10px 14px;
    margin: 5px;
    cursor: pointer;
  }

  textarea {
    width: 100%;
    height: 70px;
    font-size: 20px;
    padding: 10px;
  }

  button {
    font-size: 18px;
    padding: 12px;
    margin: 6px 0;
    width: 100%;
  }

  #feedback {
    font-size: 22px;
    margin-top: 12px;
    min-height: 30px;
  }

  #arabicHint {
    font-size: 20px;
    margin-top: 10px;
    display: none;
  }

  @media (min-width: 600px) {
    button { width: auto; }
  }
</style>
</head>

<body>

<h2>Put the words in the correct order</h2>

<p id="info"></p>
<p id="score"></p>

<div id="wordButtons"></div>

<textarea id="answerBox" placeholder="Tap words or type here"></textarea>

<button onclick="checkAnswer()">Check Answer</button>
<button onclick="speakScrambled()">üîä Hear Words</button>
<button onclick="showHint()">Hint</button>
<button onclick="toggleArabic()">Arabic Hint</button>
<button onclick="clearAnswer()">Clear</button>
<button onclick="previousSentence()">Previous</button>
<button onclick="nextSentence()">Next</button>

<p id="arabicHint"></p>
<p id="feedback"></p>

<script>
/* ================= SENTENCES ================= */
const sentences = [
  {
    scrambled: "you / from / where / are",
    correct: "Where are you from?",
    arabic: "ŸÖŸÜ ÿ£ŸäŸÜ ÿ£ŸÜÿ™ÿü"
  },
  {
    scrambled: "interested / hiking / you / in / are",
    correct: "Are you interested in hiking?",
    arabic: "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖŸáÿ™ŸÖŸë ÿ®ÿ±Ÿäÿßÿ∂ÿ© ÿßŸÑŸÖÿ¥Ÿäÿü"
  },
  {
    scrambled: "at / you / are / what / good",
    correct: "What are you good at?",
    arabic: "ÿ®ŸÖÿßÿ∞ÿß ÿ£ŸÜÿ™ ÿ®ÿßÿ±ÿπÿü"
  },
  {
    scrambled: "years / 20 / old / you / are",
    correct: "Are you 20 years old?",
    arabic: "ŸáŸÑ ÿπŸÖÿ±ŸÉ ÿπÿ¥ÿ±ŸàŸÜ ÿ≥ŸÜÿ©ÿü"
  },
];


let index = 0;

/* RESET SCORE ON PAGE LOAD */
localStorage.removeItem("score");
let score = 0;

let answered = false;

//let index = 0;
//let score = Number(localStorage.getItem("score")) || 0;
//let answered = false;

/* ================= LOAD ================= */
function loadSentence() {
  answered = false;
  document.getElementById("answerBox").value = "";
  document.getElementById("feedback").textContent = "";
  document.getElementById("arabicHint").style.display = "none";

  document.getElementById("info").textContent =
    `Sentence ${index + 1} of ${sentences.length}`;

  document.getElementById("score").textContent =
    `Score: ${score}`;

  loadWords();
}

/* ================= WORD BUTTONS ================= */
function loadWords() {
  const container = document.getElementById("wordButtons");
  container.innerHTML = "";

  let words = sentences[index].scrambled.split(" / ");
  shuffle(words);

  words.forEach(word => {
    const btn = document.createElement("button");
    btn.textContent = word;
    btn.className = "wordBtn";
    btn.onclick = () => addWord(word);
    container.appendChild(btn);
  });
}

function addWord(word) {
  const box = document.getElementById("answerBox");
  box.value += (box.value ? " " : "") + word;
}

/* ================= CHECK ================= */
function normalize(text) {
  return text.toLowerCase().trim().replace(/\s+/g, " ");
}

function checkAnswer() {
  const user = normalize(answerBox.value);
  const correct = normalize(sentences[index].correct);

  if (user === correct) {
    if (!answered) {
      score++;
      localStorage.setItem("score", score);
      answered = true;
    }
    feedback.textContent = "‚úÖ Correct! Well done!";
    speak(sentences[index].correct);
    scoreDisplay();
  } else {
    feedback.textContent = "‚ùå Try again.";
  }
}

function scoreDisplay() {
  document.getElementById("score").textContent = `Score: ${score}`;
}

/* ================= AUDIO ================= */
function speak(text) {
  speechSynthesis.cancel();
  const msg = new SpeechSynthesisUtterance(text);
  msg.rate = 0.85;
  speechSynthesis.speak(msg);
}

function speakScrambled() {
  speak(sentences[index].scrambled.replaceAll(" / ", " "));
}

/* ================= HINTS ================= */
function showHint() {
  answerBox.value = sentences[index].correct.split(" ")[0];
}

function toggleArabic() {
  const hint = document.getElementById("arabicHint");
  hint.textContent = sentences[index].arabic;
  hint.style.display =
    hint.style.display === "none" ? "block" : "none";
}

/* ================= NAV ================= */
function nextSentence() {
  if (index < sentences.length - 1) {
    index++;
    loadSentence();
  }
}

function previousSentence() {
  if (index > 0) {
    index--;
    loadSentence();
  }
}

function clearAnswer() {
  answerBox.value = "";
}

/* ================= SHUFFLE ================= */
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

/* ================= START ================= */
loadSentence();
</script>

</body>
</html>
